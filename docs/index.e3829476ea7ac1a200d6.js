(()=>{"use strict";const n="53e8b7ab-f08c-4076-9cba-79ef50d59477";function e(n){n.currentTarget===n.target&&n.target.remove()}async function t(n){const t=document.querySelector(".movies__films"),a=document.createDocumentFragment();a.innerHTML="",n.items.forEach((n=>{const t=document.createElement("div");let o=n.genres.map((n=>n.genre)).join(", ");t.classList.add("movie"),t.innerHTML='\n      <div class="movie__inner '.concat(n.ratingKinopoisk>=8?"movie__inner--green":n.ratingKinopoisk>=5?"movie__inner--yellow":"movie__inner--red",'" data-rating="').concat(n.ratingKinopoisk,'">\n      <img\n            src=').concat(n.posterUrl,"\n            alt=").concat(n.nameRu,'\n            class="movie__image"\n          />\n          <div class="movie__info">\n            <h2 class="movie__title">').concat(n.nameRu,'</h2>\n            <p class="movie__category">').concat(o,"</p>\n          </div>\n      </div>      \n    "),t.addEventListener("click",(()=>function(n){let{id:t,name:a,genres:o,image:c,url:i}=n;try{const n=document.querySelector(".movies");let t=document.createElement("div");t.className="movies__modal modal",t.innerHTML='<div class="modal__content">\n  <img\n    class="modal__image"\n    src='.concat(c,'\n    alt="Кинопоиск: Гид по аниме"\n  />\n  <h3 class="modal__name">').concat(a,'</h3>\n  <span class="modal__category">').concat(o,'</span>\n  <p class="modal__description">\n    От Миядзаки до «Евангелиона». Разбор самого важного, что надо\n    знать о японской анимации.\n  </p>\n  <a class="modal__href" target="_blank" href=').concat(i,"\n    >Посетить сайт</a\n  >\n</div>"),t.addEventListener("click",e),n.append(t)}catch(n){console.log(n)}return null}({id:n.kinopoiskId,name:n.nameRu,genres:o,image:n.posterUrl,url:"https://www.kinopoisk.ru/".concat(n.type.toLowerCase(),"/").concat(n.kinopoiskId,"/")}))),a.append(t)})),t.append(a)}let a=!1;document.querySelector(".header__form").addEventListener("submit",(async function(e){if(e.preventDefault(),a)console.log("Запрос уже выполняется...");else{a=!0;try{let a=e.target.children[0];if(!a.value)return;let o=await async function(e){let t=await fetch("https://kinopoiskapiunofficial.tech/api/v2.2/films?ratingFrom=0&ratingTo=10&yearFrom=1000&yearTo=3000&keyword="+e,{headers:{"Content-Type":"application/json","X-API-KEY":n}});return await t.json()}(a.value);a.value="",t(o)}catch(n){console.error("Ошибка:",n)}finally{a=!1}}})),async function(){try{const e=await fetch("https://kinopoiskapiunofficial.tech/api/v2.2/films/collections?type=TOP_250_MOVIES&page=1",{headers:{"Content-Type":"application/json","X-API-KEY":n}});return await e.json()}catch(n){console.log("Ошибка получения фильмов: ",n)}}().then((n=>t(n)),(n=>console.log(n)))})();